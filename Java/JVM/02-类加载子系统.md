# JVM

## JVM 内存简图

## JVM 内存详细图

## 类加载器子系统

类加载器子系统分为三个阶段：

- 加载
- 链接
- 初始化



类加载器的作用：

类加载器子系统负责从文件系统或网络中加载 class 文件。



### 加载

**JVM 有哪些类加载器**：

- 引导类加载器
- 扩展类加载器
- 系统类加载器
- 自定义类加载器



**不同加载器可以加载哪些类**：



**加载器的等级**：

引导类加载器 > 扩展类加载器 > 系统类加载器 > 自定义类加载器



**双亲委派机制**：

- 如果类加载器收到了类加载请求，它并不会自己先去加载，而是将请求给父类的加载器去执行。
- 如果父类加载器还存在其父类加载器，则进一步向上委托，依次递归，直到请求到达顶层引导类加载器。
- 如果父类加载器可以完成加载任务，直接返回，如果父类加载器不能完成任务，子类加载器才会尝试自己加载。



**为什么采用双亲委派机制？**

- 避免核心 API 被篡改
- 避免类的重复加载



### 链接

- **验证**

  目的在于验证字节码文件是否符合 JVM 要求。

- **准备**

  为类变量（static 变量）分配内存并且设置类变量的默认初始值。数据类型不一样，默认初始值不一样：

  byte : 0

  short : 0

  int : 0

  long : 0L

  float : 0.0F

  double : 0.0

  char : '\u0000'

  boolean : false

  引用类型：null

  **示例**：

  ```java
  public class Test{
  	static int age = 10;
      public static void main(String[] args){
          System.out.println(age);
      }
  }
  ```

  在上面这个示例代码中，**在准备阶段它会被放入字节码文件的常量池中（常量池属于字节码文件的一部分），并且初始值为0**而不是10。

- **解析**

### 初始化

初始化阶段就是执行类构造器方法（clinit: class-init）的过程。



## 运行时数据区

### 内存

### JVM 内存——运行时数据区



### PC 寄存器

### 虚拟机栈

- **栈内部结构**
- **局部变量表**
  - 静态方法
  - 构造方法
  - Slot 的重复使用
- **操作数栈**
  - 
- **动态链接**
- **方法返回值**
- **一些附加信息**

